# Contract Testing: –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –º–∞—Ç—Ä–∏—Ü–∞ —É—Ä–æ–≤–Ω–µ–π

## 1. –ß—Ç–æ —Ç–∞–∫–æ–µ Contract Testing

**Provider** ‚Äî –Ω–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –°–û–ó–î–ê–Å–¢ –¥–∞–Ω–Ω—ã–µ (`return [{json: {...}}]`).  
**Consumer** ‚Äî –Ω–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –ß–ò–¢–ê–ï–¢ –¥–∞–Ω–Ω—ã–µ (`$json.field`).  
**–ö–æ–Ω—Ç—Ä–∞–∫—Ç** ‚Äî —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ: —á—Ç–æ Provider –æ–±–µ—â–∞–µ—Ç –≤—ã–¥–∞—Ç—å, —á—Ç–æ Consumer –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å.

### –û—Ç–ª–∏—á–∏–µ –æ—Ç Schema Validation

| | Schema Validation | Contract Testing |
|--|---|---|
| –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö | –°–≤—è–∑—å –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ |
| –ù–∞—Ö–æ–¥–∏—Ç | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ |
| –ê–Ω–∞–ª–æ–≥ | JSONSchema, Zod | Pact.io, CDC |

### –≠—Ç–∞–ª–æ–Ω: Pact.io (11.8K ‚≠ê GitHub)
1. Consumer –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç
2. Pact –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSON-–∫–æ–Ω—Ç—Ä–∞–∫—Ç
3. Provider –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç

–≠—Ç–æ—Ç –∞–≥–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–ª—è n8n data flow.

---

## 2. –ú–∞—Ç—Ä–∏—Ü–∞ —É—Ä–æ–≤–Ω–µ–π –ø—Ä–æ–±–ª–µ–º

| –°–∏—Ç—É–∞—Ü–∏—è | –£—Ä–æ–≤–µ–Ω—å |
|----------|--------|
| Consumer —á–∏—Ç–∞–µ—Ç –ø–æ–ª–µ, Provider **–Ω–∏–∫–æ–≥–¥–∞** –Ω–µ —Å–æ–∑–¥–∞—ë—Ç, fallback –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üî¥ CRITICAL |
| Consumer —á–∏—Ç–∞–µ—Ç –ø–æ–ª–µ, Provider —Å–æ–∑–¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π –≤–µ—Ç–∫–µ, **–Ω–µ—Ç fallback** | üî¥ CRITICAL |
| Type mismatch ‚Äî —è–≤–Ω–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ (string vs boolean vs array) | üî¥ CRITICAL |
| Consumer —á–∏—Ç–∞–µ—Ç –ø–æ–ª–µ –∏–∑ —É—Å–ª–æ–≤–Ω–æ–π –≤–µ—Ç–∫–∏, **–µ—Å—Ç—å fallback** (`\|\|`, `??`, `?.`) | üü° WARNING |
| Provider —Å–æ–∑–¥–∞—ë—Ç –ø–æ–ª–µ, **–Ω–∏ –æ–¥–∏–Ω Consumer –Ω–µ —á–∏—Ç–∞–µ—Ç** (dead code) | ‚ÑπÔ∏è INFO |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –∏–ª–∏ LLM-–∑–∞–≤–∏—Å–∏–º—ã–µ –ø–æ–ª—è | ‚ùì UNCERTAIN |

**Fallback-–¥–µ—Ç–µ–∫—Ç–æ—Ä**: –Ω–∞–ª–∏—á–∏–µ `|| `, `?? `, `?.`, `|| null`, `|| 'default'` —Ä—è–¥–æ–º —Å —á—Ç–µ–Ω–∏–µ–º –ø–æ–ª—è —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Å CRITICAL –¥–æ WARNING.

---

## 3. –ë–∞–∑–∞ –ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç–æ–≤ (—Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –±–∞–≥–æ–≤)

| –ü–∞—Ç—Ç–µ—Ä–Ω | –û–ø–∏—Å–∞–Ω–∏–µ | –ß–∞—Å—Ç–æ—Ç–∞ |
|---------|----------|--------|
| **Shadow field** | Consumer —á–∏—Ç–∞–µ—Ç `field_hint`, Provider –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `field` | –í—ã—Å–æ–∫–∞—è |
| **Branch blindness** | Consumer –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–Ω—É –∏–∑ –≤–µ—Ç–æ–∫ IF | –í—ã—Å–æ–∫–∞—è |
| **Rename drift** | Provider –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª –ø–æ–ª–µ, Consumer –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∏ | –í—ã—Å–æ–∫–∞—è |
| **Type confusion** | Provider: `"true"` (string), Consumer: `=== true` (boolean) | –°—Ä–µ–¥–Ω—è—è |
| **Dead passthrough** | –ü–æ–ª–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ 3 –Ω–æ–¥—ã –∏ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –°—Ä–µ–¥–Ω—è—è |
| **Undefined cascade** | `undefined` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥–∞–ª—å—à–µ –∏ –ª–æ–º–∞–µ—Ç 3-—é –Ω–æ–¥—É | –ù–∏–∑–∫–∞—è |

---

## 4. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–≥–∞

**Provider (Model Selector):**
```javascript
return { json: { scenes: [{ model: "nano_banana", prompt: "..." }] } };
//                           ^^^^^ "model"
```

**Consumer (Map to Pipeline):**
```javascript
const model = scene.model_hint || scene.model;
//                  ^^^^^^^^^^ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ!
```

–í–µ—Ä–¥–∏–∫—Ç: `model_hint` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –±—ã–ª–æ –±—ã CRITICAL, –Ω–æ –µ—Å—Ç—å fallback `|| scene.model` ‚Üí WARNING.  
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∏–∫—Å: —É–±—Ä–∞—Ç—å `model_hint`, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `scene.model`.

---

## 5. –†–µ—Å—É—Ä—Å—ã

- **Pact.io** ‚Üí https://docs.pact.io/
- **pact-js** (11.8K ‚≠ê) ‚Üí https://github.com/pact-foundation/pact-js
- **Data Contract Specification** ‚Üí https://github.com/datacontract/datacontract-specification
- **n8n Nodelinter** (~70 –ø—Ä–∞–≤–∏–ª) ‚Üí https://github.com/n8n-io/nodelinter
